<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AngularJS 1.5.8 Uncaught Error: [$injector:modulerr] + Mongoose quirks</title>
    <meta name="Description" content="web developer, photographer, panda">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="pandamakes">
    <link rel="stylesheet" href="/css/materialize.css">
    <link rel="stylesheet" href="/css/github-markdown.css">
    <link rel="stylesheet" href="/css/coverimage.css">
	  <link rel="me" href="https://fosstodon.org/@pandamakes">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  </head>
  <body class="d-flex flex-column">
    <header class="flex-basis-0 flex-grow-0">

    <nav>
      <div class="nav-wrapper col s12">

        <!-- logo -->
        <a href="/" class="h-100 brand-logo">
          <div class="h-100 valign-wrapper ">
            <img class="h-100 p-1" src="/img/logo.svg">
            <span>
              pandamakes
            </span>
          </div>
        </a>

        <a href="#" data-target="mobile-menu" class="sidenav-trigger">
          <i class="fas fa-bars"></i>
        </a>

        <ul class="right hide-on-med-and-down"><li class="nav-item"><a href="/">Home</a></li>
<li class="nav-item"><a href="/blog/">Blog</a></li>
<li class="nav-item"><a href="/about/">About</a></li></ul>
      </div>
    </nav>

  <!-- mobile sidenav -->
  <ul class="sidenav" id="mobile-menu">
  
  
    <li class="nav-item">
      <a href="/">
        Home
      </a>
    </li>
  
  
  
    <li class="nav-item">
      <a href="/blog/">
        Blog
      </a>
    </li>
  
  
  
    <li class="nav-item">
      <a href="/about/">
        About
      </a>
    </li>
  
  
  </ul>

</header>

    <main class="flex-basis-0 flex-grow-1" >

      <div data-bgimgsrc="/img/cover.jpg" class="banner-image-wrapper w-100 h-100vh overflow-hidden d-flex align-items-center justify-content-center">
  <div>
    <h1 class="center-align">
      AngularJS 1.5.8 Uncaught Error: [$injector:modulerr] + Mongoose quirks
    </h1>

    
  </div>
</div>

<div class="row"></div>
      <div class="container">
        

<div class="row">
	<div class="col s12"
		<time datetime="2016-08-29">29 August 2016</time>
	</div>
	
  	
<div class="col s12">
  <div class="d-flex flex-wrap">

    
    <span class="mt-a mb-a"> tags: </span>
    

    
    <span data-href="/tags/angular js/" class="waves-effect chip m-1">angular js</span>
    <span data-href="/tags/angularjs/" class="waves-effect chip m-1">angularjs</span>
    <span data-href="/tags/html/" class="waves-effect chip m-1">html</span>
    <span data-href="/tags/javascript/" class="waves-effect chip m-1">javascript</span>
    <span data-href="/tags/mongo/" class="waves-effect chip m-1">mongo</span>
    <span data-href="/tags/mongodb/" class="waves-effect chip m-1">mongodb</span>
    <span data-href="/tags/mongoose/" class="waves-effect chip m-1">mongoose</span>
    <span data-href="/tags/node.js/" class="waves-effect chip m-1">node.js</span>
    <span data-href="/tags/nodejs/" class="waves-effect chip m-1">nodejs</span>
  </div>
</div>



</div>


<div class="row">
  <div class="col s12 markdown-body">
  <p>Long story short.</p>
<p>Doing some AngularJS. Keep on getting this error. First thought ngRoute needs to be included. Then ngResource.</p>
<p>Turns out, just need to include angular component outside the</p>
<p>$(document).ready(function(){})</p>
<p>Also, turns out one cannot bind jquery actions such as</p>
<p>$('#modal').modal('show')</p>
<p>I have found a get around on SO, but implementation is too complicated and I would assume the debugging process also. So I hacked it a bit. I bound ng-mouseenter with angular and left the click event to js.</p>
<p>Using mongoose to store data this time around. Saving entries … can be counter intuitive.</p>
<p>For example,</p>
<p>var lessonSchema = mongoose.Schema({
shortCode : String,
arrQuestions : Array,
progress : Number,
length : Number,
creator : String,
users : Array,
created : Date,
status : String,
})</p>
<p>lessonSchema.methods.addAnswerToAnswerSheet = function(INDEX,answerJSON){
this.users[INDEX].answerSheet.push(answerJSON)
}</p>
<p>And one of the entry looks like the following:</p>
<p>{
&quot;_id&quot; : ObjectId(&quot;57bda23bd796f12824d8b710&quot;),
&quot;status&quot; : STATUS,
&quot;created&quot; : ISODate(&quot;2016-08-24T13:33:47.831Z&quot;),
&quot;creator&quot; : CREATOR,
&quot;length&quot; : 10,
&quot;shortCode&quot; : &quot;xk4Wp&quot;,
&quot;users&quot; : [ {
&quot;strId&quot; : ID,
&quot;name&quot; : NAME,
&quot;answerSheet&quot; : []
} ],
&quot;arrQuestions&quot; : [ {
&quot;mark&quot; : &quot;&quot;,
&quot;space&quot; : &quot;&quot;,
&quot;answer&quot; : ANSWER,
&quot;question&quot; : QUESTION,
&quot;hashed_id&quot; : HASHED_ID,
&quot;subject&quot; : SUBJECT,
&quot;note&quot; : &quot;&quot; },
...
],
&quot;__v&quot; : 2,
&quot;progress&quot; : 1
}</p>
<p>and calling the methods does not seem to work as intended…. i.e.:</p>
<p>var query = {...}
var index = INDEX
var json = JSON
var submitAnswer = Lesson.findOne(query,function(e,lesson){
if(e){
console.log(e)
}else{
lesson.addAnswerToAnswerSheet(index,json)
lesson.save(function(e1){
if(e1){
console.log(e1)
}
})
}
})</p>
<p>does not save the document.</p>
<p>I believe the error was that you cannot individually interact with a sub document, unless you define its schema. So to solve the problem, I defined each user as a different schema.</p>
<p>var userSchema = mongoose.Schema({
name : String,
strId : String,
answerSheet : String /* stringified JSON objects */
})</p>
<p>var lessonSchema = mongoose.Schema({
shortCode : String,
arrQuestions : Array,
progress : Number,
length : Number,
creator : String,
users : [userSchema],
created : Date,
status : String
})</p>
<p>Seems to work just fine…</p>
<p>UPDATE : (21/10/2016) mongoose not saving is a result of the model not recognising that the model had been changed. To force a save:</p>
<p>doc.markModified('field') doc.save(function(e){ })</p>

  </div>
</div>
<ul class="links-nextprev"><li>Previous: <a href="/posts/dabbling-into-wordpress-woocommerce-woocommerce-color-or-not/">dabbling into wordpress woocommerce + woocommerce color (or not)</a></li><li>Next: <a href="/posts/html-form-hack/">HTML form hack</a></li>
</ul>

      </div>
    </main>

    <footer class="page-footer flex-basis-0 flex-grow-0">

  <div class="container">
    <div class="row">
      <div class="col s12">

        <a class="btn-flat" href="https://github.com/xgui3783">
          <i class="fab fa-github"></i>
          <span>
            xgui3783
          </span>
        </a>

        <a href="https://fosstodon.org/@pandamakes" class="btn-flat">
          <i class="fab fa-mastodon"></i>
          <span>
            @pandamakes@fosstodon.org
          </span>
        </a>
      </div>
    </div>
  </div>
  
  <div class="footer-copyright">
    <div class="container">
    © 2024 Copyright pandamakes
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {

      /* required for SideBar mobile */
      const elems = document.querySelectorAll('.sidenav')
      const instances = M.Sidenav.init(elems)

      /* required to overcome nested anchor links */
      const divHrefs = document.querySelectorAll('[data-href]')
      for (const divHref of divHrefs ){
        divHref.addEventListener('click', ev => {
          window.open(divHref.dataset.href, '_self')
          ev.stopPropagation()
        })
      }
    })
  </script>

</footer>
    <!-- Current page: /posts/angularjs-1-5-8-uncaught-error-injectormodulerr/ -->
  </body>
</html>
